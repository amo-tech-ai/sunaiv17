
# Phase 1: Screen 4 Core Implementation (The Executive Brief UI)

**Progress Tracker:** Step 4 of 5 (Core Phase)
**Status:** Ready for Dev
**Goal:** Transform Screen 4 from a manual "Readiness Checklist" into a read-only "Executive Strategy Brief" that summarizes the user's journey.
**AI Model:** `gemini-3-flash-preview` (Low latency, summarization)

---

## 1. Progress Tracker & Status

| Milestone | Component | Status | Description |
| :--- | :--- | :---: | :--- |
| **Architecture** | 3-Panel Layout | ðŸ”´ Pending | Refactor to Left (Brief), Center (Strategy), Right (Consultant). |
| **Data Flow** | Input Aggregation | ðŸ”´ Pending | Collect Data: Step 1 (Services), Step 2 (Pain), Step 3 (Systems). |
| **Logic** | Scoring V1 | ðŸ”´ Pending | Calculate "Readiness" based on Step 1 Maturity Score (not manual checks). |
| **Backend** | `summary` Function | ðŸ”´ Pending | Create Edge Function to synthesize inputs. |
| **UI** | Component Swap | ðŸ”´ Pending | Replace `Step4Readiness.tsx` with `Step4Summary.tsx`. |

---

## 2. Executive Summary Strategy

This screen acts as the **"Mirror"**. It reflects the user's inputs back to them, framed as a strategic analysis.
*   **Input Sources:**
    *   **Screen 1:** Business Name, Industry, Selected Services (e.g., Shopify, WhatsApp).
    *   **Screen 2:** Pain Points (e.g., "Slow Response Time").
    *   **Screen 3:** Selected AI Systems (e.g., "Lead Gen Engine").
*   **Output:** A cohesive dashboard confirming *why* these systems were chosen for this specific business.

---

## 3. Three-Panel Layout Architecture

### Left Panel (20%) â€” The Client Brief (Context Anchor)
*   **Purpose:** Establishes the "Truth Baseline". Visual proof we know who they are.
*   **Content:**
    *   **Profile:** Business Name + Industry Badge (e.g., "Fashion E-commerce").
    *   **Tech Stack:** List of **Selected Services** from Step 1 (e.g., "Shopify", "Klaviyo").
    *   **Primary Goal:** The main priority selected in Step 2.
    *   **Navigation:** "Edit Context" link (returns to Step 1).

### Center Panel (50%) â€” The Strategic Analysis (Work Area)
*   **Purpose:** The core deliverable.
*   **Content:**
    1.  **Readiness Dial:** Large SVG circular progress (0-100).
        *   *Core Logic:* `Score = Step1_Maturity_Score * 20`. (Simple, deterministic).
    2.  **Solution Stack:** Horizontal cards showing the 2-3 systems selected in Step 3.
        *   *Visual:* System Icon + Title + "Why: Solves [Pain Point]".
    3.  **Basic Narrative:** A 2-sentence summary generated by Gemini Flash.
        *   *Template:* "For a [Industry] business using [Service], these systems will address your [Pain Point] bottleneck."

### Right Panel (30%) â€” The Consultant (Feedback)
*   **Purpose:** Explain the "How".
*   **Content:**
    *   **Live Logic Stream:** "Analyzing tech stack..." -> "Mapping solutions..."
    *   **Value Prop:** Bullet points on how AI assists their specific business model.

---

## 4. User Journey Flow (Core)

1.  **Entry:** User completes Step 3 (System Selection).
2.  **Processing:** UI shows a "Synthesizing Strategy..." skeleton loader (approx. 2s).
3.  **Data Fetch:** Frontend calls `supabase/functions/summary`.
4.  **Display:**
    *   **Left:** Shows the user's tech stack (Services).
    *   **Center:** Animates the Readiness Score and lists the selected systems.
    *   **Right:** Streams a short confirmation message.
5.  **Action:** User clicks "Reveal Roadmap" to proceed to Step 5.

---

## 5. Implementation Prompts (Sequential)

### Prompt 1: The Summary Edge Function (Flash)
```text
Create `supabase/functions/summary/index.ts`.
- Model: `gemini-3-flash-preview`.
- Inputs: `wizardState` (Full AppState).
- Logic:
  1. Calculate `readinessScore`: Use `data.analysis.maturity_score` (1-5) * 20.
  2. Generate `narrative`: A concise paragraph summarizing how the selected systems (Step 3) help the specific Industry (Step 1).
  3. Generate `value_props`: 3 bullet points specific to their Selected Services (e.g., if 'Shopify', mention 'Inventory Sync').
- Output Schema:
  {
    score: number,
    headline: string,
    narrative: string,
    value_props: string[]
  }
```

### Prompt 2: Frontend UI Components (`Step4Summary.tsx`)
```text
Create `components/wizard/Step4Summary.tsx` to replace `Step4Readiness.tsx`.
- **Layout:** Standard 3-panel `WizardLayout`.
- **Left Panel:** Render `ClientBrief` component displaying Business Name, Industry, and `selectedServices` tags.
- **Center Panel:**
  - `ReadinessScore`: SVG Circle displaying the score.
  - `SolutionStack`: List of selected systems using the existing System Card design (scaled down).
  - `Narrative`: Text block for the AI summary.
- **Right Panel:** Display `value_props` as a "Key Benefits" list.
```

### Prompt 3: Wiring & Integration
```text
Update `WizardFlow.tsx`.
- Import `Step4Summary`.
- Replace the `Step4Readiness` case.
- Pass `data`, `aiState`, and `updateData` props.
- Ensure the `summary` Edge Function is called via `useEffect` on mount.
```
